{"version":3,"file":"shapesvg.js","sources":["../src/consts.ts","../src/index.ts"],"sourcesContent":["export const TOP = \"top\";\nexport const BOTTOM = \"bottom\";\nexport const LEFT = \"left\";\nexport const RIGHT = \"right\";\nexport type DIRECTION = \"top\" | \"bottom\" | \"left\" | \"right\";\nexport type STROKE_LINEJOIN = \"bevel\" | \"round\" | \"miter\" | \"miter-clip\" | \"arcs\";\nexport const CLASS_NAME = \"__shape-svg\";\n","import { CLASS_NAME, STROKE_LINEJOIN } from \"./consts\";\n\ninterface SVGInterface {\n  left?: number;\n  top?: number;\n  right?: number;\n  bottom?: number;\n  side?: number;\n  split?: number;\n  width?: number;\n  height?: number;\n  strokeWidth?: number;\n  strokeLinejoin?: STROKE_LINEJOIN;\n  innerRadius?: number;\n  [key: string]: any;\n}\n\nfunction makeDOM(tag: string) {\n  return document.createElementNS(\"http://www.w3.org/2000/svg\", tag);\n}\nfunction makeSVGDOM() {\n  const el = makeDOM(\"svg\");\n\n  el.setAttribute(\"class\", CLASS_NAME);\n  return el;\n}\nexport function getRect({\n  side = 3,\n  rotate = 0,\n  innerRadius = 100,\n  width = 0,\n  height = 0,\n  strokeLinejoin = \"round\",\n  strokeWidth = 0,\n}: SVGInterface) {\n  let xPoints: number[] = [];\n  let yPoints: number[] = [];\n  const sideCos = Math.cos(Math.PI / side);\n  const startRad = Math.PI / 180 * rotate +  Math.PI * ((side % 2 ? 0 : 1 / side) - 1 / 2);\n\n  for (let i = 0; i < side; ++i) {\n    const rad = Math.PI * (1 / side * 2 * i) + startRad;\n    const cos = Math.cos(rad);\n    const sin = Math.sin(rad);\n\n    xPoints.push(cos);\n    yPoints.push(sin);\n    if (innerRadius !== 100) {\n      if (sideCos <= innerRadius / 100) {\n        continue;\n      } else {\n        xPoints.push(innerRadius / 100 * Math.cos(rad + Math.PI / side));\n        yPoints.push(innerRadius / 100 * Math.sin(rad + Math.PI / side));\n      }\n    }\n  }\n  const minX = Math.min(...xPoints);\n  const minY = Math.min(...yPoints);\n  const maxX = Math.max(...xPoints);\n  const maxY = Math.max(...yPoints);\n  const isWidth = !!width;\n  const scale = isWidth ? width / (maxX - minX) : height / (maxY - minY);\n  const isOuter = strokeLinejoin === \"miter\" || strokeLinejoin === \"arcs\" || strokeLinejoin === \"miter-clip\";\n\n  const sideSin = Math.sin(Math.PI / side);\n  const innerCos = Math.min(sideCos, innerRadius / 100);\n  const innerScale = scale * innerCos;\n  const diagonal = strokeWidth / 2 / (sideCos === innerCos ? 1 : Math.sin(Math.atan(sideSin / (sideCos - innerCos))));\n  const outerScale = isOuter ? (innerScale + diagonal) / innerScale : 1;\n  const pos = isOuter ? 0 : strokeWidth / 2;\n\n  xPoints = xPoints.map(xp => (xp - minX * outerScale) * scale + pos);\n  yPoints = yPoints.map(yp => (yp - minY * outerScale) * scale + pos);\n\n  const polygonWidth = (maxX - minX) * outerScale * scale + pos * 2;\n  const polygonHeight = (maxY - minY) * outerScale * scale + pos * 2;\n  const points = xPoints.map((xp, i) => [xp, yPoints[i]]);\n  return {points, width: polygonWidth, height: polygonHeight};\n}\nexport function star({\n  side = 3,\n  innerRadius = 60 * Math.cos(Math.PI / side),\n}: SVGInterface,     container?: SVGAElement) {\n  return poly({...arguments[0], innerRadius}, container);\n}\nexport function poly({\n  left = 0,\n  top = 0,\n  right = 0,\n  bottom = 0,\n  strokeWidth,\n  strokeLinejoin = \"round\",\n  fill = \"transparent\",\n  side,\n  width,\n  height,\n  rotate,\n  innerRadius = 100,\n  ...attributes\n}: SVGInterface,     container: SVGElement = makeSVGDOM()) {\n  const {points, width: polygonWidth, height: polygonHeight } =\n    getRect({side, rotate, width, height, innerRadius, strokeLinejoin, strokeWidth});\n\n  const polygon: SVGPolygonElement = makeDOM(\"polygon\") as SVGPolygonElement;\n\n  if (container.getAttribute(\"class\") === CLASS_NAME) {\n    container.setAttribute(\"viewBox\", `0 0 ${left + polygonWidth + right} ${top + polygonHeight + bottom}`);\n  }\n  polygon.setAttribute(\"fill\", fill);\n  polygon.setAttribute(\"stroke-linejoin\", strokeLinejoin);\n  polygon.setAttribute(\"stroke-width\", `${strokeWidth}`);\n  polygon.setAttribute(\"points\", points.map(point => `${left + point[0]},${top + point[1]}`).join(\" \"));\n\n  for (const name in attributes) {\n    polygon.setAttribute(name, attributes[name]);\n  }\n  container.appendChild(polygon);\n  return container;\n}\nexport const VERSION = \"#__VERSION__#\";\n"],"names":["CLASS_NAME","makeDOM","tag","document","createElementNS","makeSVGDOM","el","setAttribute","getRect","_a","_b","side","_c","rotate","_d","innerRadius","_e","width","_f","height","_g","strokeLinejoin","_h","strokeWidth","xPoints","yPoints","sideCos","Math","cos","PI","startRad","i","rad","sin","push","minX","min","minY","maxX","max","maxY","isWidth","scale","isOuter","sideSin","innerCos","innerScale","diagonal","atan","outerScale","pos","map","xp","yp","polygonWidth","polygonHeight","points","star","container","poly","arguments","left","top","right","bottom","fill","attributes","_j","polygon","getAttribute","point","join","name","appendChild","VERSION"],"mappings":"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"}